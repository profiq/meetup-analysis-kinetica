
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Meetup.com Map</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Include Mapbox stylesheet -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.41.0/mapbox-gl.css' rel='stylesheet' />

    <!-- Include Kickbox CSS -->
    <link rel="stylesheet" href='./kickbox.css' />

    <!-- Generic styles for Mapbox map -->
    <style>
        body { margin:0; padding:0;}
        #map { position:absolute; top:0; bottom:0; width:100%; transition: all 0.3s; }
    </style>
</head>
<body>
<!-- Include a map div -->
<div id='map'></div>

<!-- Include mapbox and kickbox library -->
<script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.52.0-beta.1/mapbox-gl.js"></script>
<script src="./kickbox.min.js"></script>
<script>
    (function(mapboxgl) {

        // Initialize the map
        var kbConfig = {
            kineticaUrl: 'http://192.168.88.140:9191',
            wmsUrl: 'http://192.168.88.140:9191/wms',
            mapboxKey: 'pk.eyJ1IjoibXN2YW5hcHJvZmlxIiwiYSI6ImNqb3R6dDk0YzEzOXgzcHBjcHB4ZGFzc3AifQ.JwAE4uhGh1fr2bz9mvMBmQ',
            tableName: 'event_rsvp',
            xColumnName: 'lon',
            yColumnName: 'lat',
            // geohashColumnName: 'your_geohash_column_name',
            center: [-74.2598555, 40.6971494],
            zoom: 2.0,
            // If using basic authentication
            // username: '',
            // password: ''
        };

        var layerId = kbConfig.tableName + '-raster';

        kickbox.initMap({
            mapDiv: 'map',
            mapboxgl: mapboxgl,
            mapboxKey: kbConfig.mapboxKey,
            kineticaUrl: kbConfig.kineticaUrl,
            wmsUrl: kbConfig.wmsUrl,
            zoom: kbConfig.zoom,
            center: kbConfig.center,
        }).then(function(map) {

            window.map = map;

            // Add a raster layer to the map
            kickbox.addWmsLayer(map, {
                layerType: 'heatmap',
                tableName: kbConfig.tableName,
                wmsUrl: kbConfig.wmsUrl,
                layerId: layerId,
                xAttr: 'lon',
                yAttr: 'lat',
                renderingOptions: {
                    POINTCOLORS: '00FF00',
                    POINTSIZES: 3
                },
            });
        });

    })(window.mapboxgl);
</script>
</body>
</html>